{"version":3,"sources":["webpack:///./src/views/room/children/index.vue?5a81","webpack:///src/views/room/children/index.vue","webpack:///./src/views/room/children/index.vue?5a84","webpack:///./src/views/room/children/index.vue","webpack:///./src/views/room/children/index.vue?119c"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","title","left-text","NavName","left-arrow","on","click-left","$event","$router","back","scopedSlots","_u","key","fn","to","name","size","proxy","id","success-text","isCompleted","refresh","loadHistory","model","value","callback","$$v","isLoading","expression","currentMessageList","userInfo","toUserInfo","currentConversation","userProfile","onAvatarClick","hideMenu","hideEmoj","hideMore","showEmoj","showMore","sendText","sendImage","sendVideo","sendFile","staticRenderFns","childrenvue_type_script_lang_js_","components","MessageList","message_list","chatInput","[object Object]","count","computed","Object","vuex_esm","state","conversation","currentUnreadCount","unreadCount","nextReqMessageID","type","nick","toAccount","groupProfile","conversationID","methods","promise","tim","getMessageList","then","res","$store","commit","data","messageList","$bus","$emit","console","log","textMsg","hideDrawer","trim","length","message","createTextMessage","conversationType","currentConversationType","payload","text","sendMessage","catch","imError","warn","createImageMessage","file","document","getElementById","onProgress","percent","$set","imagePickerNode","createVideoMessage","videoPickerNode","createFileMessage","filePickerNode","$nextTick","messageListNode","scrollTop","scrollHeight","$on","scrollMessageListToButtom","JSON","parse","localStorage","getItem","getMsgList","room_childrenvue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_10_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_10_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_10_oneOf_1_2_node_modules_less_loader_dist_cjs_js_ref_10_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_c519d37a_scoped_true_lang_less___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_10_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_10_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_10_oneOf_1_2_node_modules_less_loader_dist_cjs_js_ref_10_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_c519d37a_scoped_true_lang_less___WEBPACK_IMPORTED_MODULE_0___default","n"],"mappings":"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","file":"js/chunk-5e98069e.0e169b6e.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"room\"},[_c('van-nav-bar',{staticClass:\"header\",attrs:{\"title\":\"\",\"left-text\":_vm.NavName,\"left-arrow\":\"\"},on:{\"click-left\":function($event){return _vm.$router.back()}},scopedSlots:_vm._u([{key:\"right\",fn:function(){return [_c('router-link',{attrs:{\"to\":{name: 'roomInfo'}}},[_c('van-icon',{attrs:{\"name\":\"ellipsis\",\"size\":\"16\"}})],1)]},proxy:true}])}),_c('van-pull-refresh',{attrs:{\"id\":\"van-pull-refresh\",\"success-text\":_vm.isCompleted ? '已加载全部':'刷新成功'},on:{\"refresh\":_vm.loadHistory},model:{value:(_vm.isLoading),callback:function ($$v) {_vm.isLoading=$$v},expression:\"isLoading\"}},[_c('message-list',{attrs:{\"currentMessageList\":_vm.currentMessageList,\"userInfo\":_vm.userInfo,\"toUserInfo\":_vm.currentConversation.userProfile},on:{\"onAvatarClick\":_vm.onAvatarClick}})],1),_c('chat-input',{attrs:{\"hideMenu\":_vm.hideMenu,\"hideEmoj\":_vm.hideEmoj,\"hideMore\":_vm.hideMore},on:{\"showEmoj\":_vm.showEmoj,\"showMore\":_vm.showMore,\"sendText\":_vm.sendText,\"sendImage\":_vm.sendImage,\"sendVideo\":_vm.sendVideo,\"sendFile\":_vm.sendFile}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"room\">\r\n    <van-nav-bar class=\"header\" title :left-text=\"NavName\" left-arrow @click-left=\"$router.back()\">\r\n      <template #right>\r\n        <router-link :to=\"{name: 'roomInfo'}\">\r\n          <van-icon name=\"ellipsis\" size=\"16\" />\r\n        </router-link>\r\n      </template>\r\n    </van-nav-bar>\r\n\r\n    <van-pull-refresh\r\n      id=\"van-pull-refresh\"\r\n      v-model=\"isLoading\"\r\n      :success-text=\"isCompleted ? '已加载全部':'刷新成功'\"\r\n      @refresh=\"loadHistory\"\r\n    >\r\n      <message-list\r\n        :currentMessageList=\"currentMessageList\"\r\n        :userInfo=\"userInfo\"\r\n        :toUserInfo=\"currentConversation.userProfile\"\r\n        @onAvatarClick=\"onAvatarClick\"\r\n      />\r\n    </van-pull-refresh>\r\n    <!-- 底部输入框 -->\r\n    <chat-input\r\n      :hideMenu=\"hideMenu\"\r\n      :hideEmoj=\"hideEmoj\"\r\n      :hideMore=\"hideMore\"\r\n      @showEmoj=\"showEmoj\"\r\n      @showMore=\"showMore\"\r\n      @sendText=\"sendText\"\r\n      @sendImage=\"sendImage\"\r\n      @sendVideo=\"sendVideo\"\r\n      @sendFile=\"sendFile\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport MessageList from \"@/components/message/message-list.vue\";\r\nimport chatInput from \"@/components/chatInput/index.vue\";\r\nimport { mapState, mapGetters } from \"vuex\";\r\nexport default {\r\n  name: \"room\",\r\n  components: {\r\n    MessageList,\r\n    chatInput\r\n  },\r\n  data() {\r\n    return {\r\n      hideMenu: true,\r\n      hideEmoj: true,\r\n      hideMore: true,\r\n      count: 10,\r\n      userInfo: {},\r\n      isLoading: false\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapState({\r\n      currentConversation: state => state.conversation.currentConversation,\r\n      currentUnreadCount: state =>\r\n        state.conversation.currentConversation.unreadCount,\r\n      currentMessageList: state => state.conversation.currentMessageList,\r\n      nextReqMessageID: state => state.conversation.nextReqMessageID,\r\n      isCompleted: state => state.conversation.isCompleted,\r\n    }),\r\n    ...mapGetters(\"conversation\", [\"toAccount\", \"currentConversationType\"]),\r\n\r\n    NavName() {\r\n      if (this.currentConversation.type === \"C2C\") {\r\n        return this.currentConversation.userProfile.nick || this.toAccount;\r\n      } else if (this.currentConversation.type === \"GROUP\") {\r\n        return this.currentConversation.groupProfile.name || this.toAccount;\r\n      } else if (this.currentConversation.conversationID === \"@TIM#SYSTEM\") {\r\n        return \"系统通知\";\r\n      }\r\n      return this.toAccount;\r\n    }\r\n  },\r\n  methods: {\r\n    // 加载初始页面消息\r\n    getMsgList() {\r\n      // 历史消息列表\r\n      let conversationID = this.currentConversation.conversationID;\r\n      let promise = this.tim.getMessageList({\r\n        conversationID: conversationID,\r\n        count: this.count\r\n      });\r\n      promise.then(res => {\r\n        this.$store.commit(\r\n          \"conversation/pushCurrentMessageList\",\r\n          res.data.messageList\r\n        );\r\n        this.$store.commit(\r\n          \"conversation/updateNextReqMessageID\",\r\n          res.data.nextReqMessageID\r\n        );\r\n        this.$store.commit(\r\n          \"conversation/updateIsCompleted\",\r\n          res.data.isCompleted\r\n        )\r\n      });\r\n      // 滚动到底部\r\n      this.$bus.$emit(\"scroll-bottom\");\r\n    },\r\n    loadHistory() {\r\n      this.isLoading = true;\r\n      // 更多消息列表\r\n      let conversationID = this.currentConversation.conversationID;\r\n      let promise = this.tim.getMessageList({\r\n        conversationID: conversationID,\r\n        nextReqMessageID: this.nextReqMessageID,\r\n        count: this.count\r\n      });\r\n      promise.then(res => {\r\n        console.log(res.data)\r\n        this.$store.commit(\r\n          \"conversation/unshiftCurrentMessageList\",\r\n          res.data.messageList\r\n        );\r\n        // 用于续拉，分页续拉时需传入该字段。\r\n        this.$store.commit(\r\n          \"conversation/updateNextReqMessageID\",\r\n          res.data.nextReqMessageID\r\n        );\r\n        this.$store.commit(\r\n          \"conversation/updateIsCompleted\",\r\n          res.data.isCompleted\r\n        )\r\n        this.isLoading = false;\r\n      });\r\n    },\r\n    showEmoj() {\r\n      if (!this.hideMenu && this.hideEmoj) {\r\n        this.hideEmoj = !this.hideEmoj;\r\n        this.hideMore = !this.hideMore;\r\n        return;\r\n      }\r\n      this.hideMenu = !this.hideMenu;\r\n      this.hideEmoj = !this.hideEmoj;\r\n    },\r\n    showMore() {\r\n      if (!this.hideMenu && this.hideMore) {\r\n        this.hideEmoj = !this.hideEmoj;\r\n        this.hideMore = !this.hideMore;\r\n        return;\r\n      }\r\n      this.hideMenu = !this.hideMenu;\r\n      this.hideMore = !this.hideMore;\r\n    },\r\n    //隐藏抽屉栏\r\n    hideDrawer() {\r\n      this.hideMenu = true;\r\n      this.hideEmoj = true;\r\n      this.hideMore = true;\r\n    },\r\n    // 点击头像\r\n    onAvatarClick(userInfo) {\r\n      console.log(\"onAvatarClick\", userInfo);\r\n    },\r\n    // 发送文字消息\r\n    sendText(textMsg) {\r\n      this.hideDrawer(); //隐藏抽屉\r\n      if (!textMsg || textMsg.trim().length === 0) {\r\n        return;\r\n      }\r\n\r\n      let message = this.tim.createTextMessage({\r\n        to: this.toAccount,\r\n        conversationType: this.currentConversationType,\r\n        payload: {\r\n          text: textMsg\r\n        }\r\n      });\r\n      this.$store.commit(\"conversation/pushCurrentMessageList\", message);\r\n      this.tim\r\n        .sendMessage(message)\r\n        .then(res => {\r\n          this.$bus.$emit(\"scroll-bottom\");\r\n        })\r\n        .catch(function(imError) {\r\n          // 发送失败\r\n          console.warn(\"sendMessage error:\", imError);\r\n        });\r\n    },\r\n    // 发送图片\r\n    sendImage() {\r\n      this.hideDrawer();\r\n      const message = this.tim.createImageMessage({\r\n        to: this.toAccount,\r\n        conversationType: this.currentConversationType,\r\n        payload: {\r\n          file: document.getElementById(\"imagePicker\") // 或者用event.target\r\n        },\r\n        onProgress: percent => {\r\n          this.$set(message, \"progress\", percent); // 手动给message 实例加个响应式属性: progress\r\n        }\r\n      });\r\n      this.$store.commit(\"conversation/pushCurrentMessageList\", message);\r\n      this.tim\r\n        .sendMessage(message)\r\n        .then(() => {\r\n          let imagePickerNode = document.getElementById(\"imagePicker\")\r\n          imagePickerNode.value = null;\r\n          this.$bus.$emit(\"scroll-bottom\");\r\n        })\r\n        .catch(imError => {\r\n          console.warn(\"sendMessage error:\", imError);\r\n        });\r\n    },\r\n    // 发送视频\r\n    sendVideo() {\r\n      this.hideDrawer();\r\n      const message = this.tim.createVideoMessage({\r\n        to: this.toAccount,\r\n        conversationType: this.currentConversationType,\r\n        payload: {\r\n          file: document.getElementById(\"videoPicker\") // 或者用event.target\r\n        },\r\n        onProgress: percent => {\r\n          this.$set(message, \"progress\", percent); // 手动给message 实例加个响应式属性: progress\r\n        }\r\n      });\r\n      this.$store.commit(\"conversation/pushCurrentMessageList\", message);\r\n      this.tim\r\n        .sendMessage(message)\r\n        .then(() => {\r\n          let videoPickerNode = document.getElementById(\"videoPicker\")\r\n          videoPickerNode.value = null;\r\n          this.$bus.$emit(\"scroll-bottom\");\r\n        })\r\n        .catch(imError => {\r\n          console.warn(\"sendMessage error:\", imError);\r\n        });\r\n    },\r\n    //发送文件\r\n    sendFile() {\r\n      this.hideDrawer();\r\n      const message = this.tim.createFileMessage({\r\n        to: this.toAccount,\r\n        conversationType: this.currentConversationType,\r\n        payload: {\r\n          file: document.getElementById(\"filePicker\") // 或者用event.target\r\n        },\r\n        onProgress: percent => {\r\n          this.$set(message, \"progress\", percent); // 手动给message 实例加个响应式属性: progress\r\n        }\r\n      });\r\n      this.$store.commit(\"conversation/pushCurrentMessageList\", message);\r\n      this.tim\r\n        .sendMessage(message)\r\n        .then(() => {\r\n          let filePickerNode = document.getElementById(\"filePicker\")\r\n          filePickerNode.value = null;\r\n          this.$bus.$emit(\"scroll-bottom\");\r\n        })\r\n        .catch(imError => {\r\n          console.warn(\"sendMessage error:\", imError);\r\n        });\r\n    },\r\n    // 直接滚到底部\r\n    scrollMessageListToButtom() {\r\n      this.$nextTick(() => {\r\n        let messageListNode = document.getElementById(\"message-list\");\r\n        if (!messageListNode) {\r\n          console.log(\"messageListNode undefined\");\r\n          return;\r\n        } \r\n        messageListNode.scrollTop = messageListNode.scrollHeight;\r\n      });\r\n    }\r\n  },\r\n  mounted() {\r\n    this.$bus.$on(\"scroll-bottom\", this.scrollMessageListToButtom);\r\n    this.$bus.$on(\"hideDrawer\", this.hideDrawer);\r\n    this.userInfo = JSON.parse(localStorage.getItem(\"userInfo\")) || {};\r\n    this.getMsgList();\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped lang='less'>\r\n.room {\r\n  // background: #fff;\r\n  padding-top: 46px;\r\n  height: 100vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  .header {\r\n    position: fixed;\r\n    left: 0;\r\n    top: 0;\r\n    width: 100vw;\r\n    height: 46px;\r\n    background: #fff;\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=c519d37a&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=c519d37a&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"c519d37a\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=c519d37a&scoped=true&lang=less&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=c519d37a&scoped=true&lang=less&\""],"sourceRoot":""}