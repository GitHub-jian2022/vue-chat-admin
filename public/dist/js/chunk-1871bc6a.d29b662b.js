(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1871bc6a"],{4877:function(e,t,s){},ad65:function(e,t,s){"use strict";var o=s("4877"),i=s.n(o);i.a},ce76:function(e,t,s){"use strict";s.r(t);var o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("router-view")},i=[],n=s("1ae8"),r=s("d05c"),a=s("2f62"),c={name:"room",components:{MessageList:n["a"],chatInput:r["a"]},data(){return{hideMenu:!0,hideEmoj:!0,hideMore:!0,count:10,userInfo:{},isLoading:!1}},computed:{...Object(a["c"])({currentConversation:e=>e.conversation.currentConversation,currentUnreadCount:e=>e.conversation.currentConversation.unreadCount,currentMessageList:e=>e.conversation.currentMessageList,nextReqMessageID:e=>e.conversation.nextReqMessageID,isCompleted:e=>e.conversation.isCompleted}),...Object(a["b"])("conversation",["toAccount","currentConversationType"]),NavName(){return"C2C"===this.currentConversation.type?this.currentConversation.userProfile.nick||this.toAccount:"GROUP"===this.currentConversation.type?this.currentConversation.groupProfile.name||this.toAccount:"@TIM#SYSTEM"===this.currentConversation.conversationID?"系统通知":this.toAccount}},watch:{isSDKReady(e){e?this.getMsgList():this.$router.replace("/login")}},methods:{getMsgList(){let e=this.currentConversation.conversationID,t=this.tim.getMessageList({conversationID:e,count:this.count});t.then(e=>{this.$store.commit("conversation/pushCurrentMessageList",e.data.messageList),this.$store.commit("conversation/updateNextReqMessageID",e.data.nextReqMessageID)}),this.$bus.$emit("scroll-bottom")},loadHistory(){this.isLoading=!0;let e=this.currentConversation.conversationID,t=this.tim.getMessageList({conversationID:e,nextReqMessageID:this.nextReqMessageID,count:this.count});t.then(e=>{this.$store.commit("conversation/unshiftCurrentMessageList",e.data.messageList),this.$store.commit("conversation/updateNextReqMessageID",e.data.nextReqMessageID),this.isLoading=!1})},showEmoj(){if(!this.hideMenu&&this.hideEmoj)return this.hideEmoj=!this.hideEmoj,void(this.hideMore=!this.hideMore);this.hideMenu=!this.hideMenu,this.hideEmoj=!this.hideEmoj},showMore(){if(!this.hideMenu&&this.hideMore)return this.hideEmoj=!this.hideEmoj,void(this.hideMore=!this.hideMore);this.hideMenu=!this.hideMenu,this.hideMore=!this.hideMore},hideDrawer(){this.hideMenu=!0,this.hideEmoj=!0,this.hideMore=!0},msgListClick(){this.hideDrawer()},onAvatarClick(e){console.log("onAvatarClick",e)},sendText(e){if(this.hideDrawer(),!e||0===e.trim().length)return;let t=this.tim.createTextMessage({to:this.toAccount,conversationType:this.currentConversationType,payload:{text:e}});this.$store.commit("conversation/pushCurrentMessageList",t),this.tim.sendMessage(t).then(e=>{this.$bus.$emit("scroll-bottom")}).catch(function(e){console.warn("sendMessage error:",e)})},sendImage(){this.hideDrawer();const e=this.tim.createImageMessage({to:this.toAccount,conversationType:this.currentConversationType,payload:{file:document.getElementById("imagePicker")},onProgress:t=>{this.$set(e,"progress",t)}});this.$store.commit("conversation/pushCurrentMessageList",e),this.tim.sendMessage(e).then(()=>{let e=document.getElementById("imagePicker");e.value=null,this.$bus.$emit("scroll-bottom")}).catch(e=>{console.warn("sendMessage error:",e)})},sendVideo(){this.hideDrawer();const e=this.tim.createVideoMessage({to:this.toAccount,conversationType:this.currentConversationType,payload:{file:document.getElementById("videoPicker")},onProgress:t=>{this.$set(e,"progress",t)}});this.$store.commit("conversation/pushCurrentMessageList",e),this.tim.sendMessage(e).then(()=>{let e=document.getElementById("videoPicker");e.value=null,this.$bus.$emit("scroll-bottom")}).catch(e=>{console.warn("sendMessage error:",e)})},sendFile(){this.hideDrawer();const e=this.tim.createFileMessage({to:this.toAccount,conversationType:this.currentConversationType,payload:{file:document.getElementById("filePicker")},onProgress:t=>{this.$set(e,"progress",t)}});this.$store.commit("conversation/pushCurrentMessageList",e),this.tim.sendMessage(e).then(()=>{let e=document.getElementById("filePicker");e.value=null,this.$bus.$emit("scroll-bottom")}).catch(e=>{console.warn("sendMessage error:",e)})},scrollMessageListToButtom(){this.$nextTick(()=>{let e=document.getElementById("message-list");e?e.scrollTop=e.scrollHeight:console.log("messageListNode undefined")})}},mounted(){this.$bus.$on("scroll-bottom",this.scrollMessageListToButtom),this.userInfo=JSON.parse(localStorage.getItem("userInfo"))||{}}},h=c,u=(s("ad65"),s("2877")),d=Object(u["a"])(h,o,i,!1,null,"76c5c94c",null);t["default"]=d.exports}}]);
//# sourceMappingURL=chunk-1871bc6a.d29b662b.js.map