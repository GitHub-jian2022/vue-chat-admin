(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-718e3422"],{"1ae8":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"message-list",attrs:{id:"message-list"},on:{click:e.msgListClick}},[e._l(e.currentMessageList,function(t,n){return i("div",{key:n,staticClass:"row"},[e.timeFliter(t,n)?i("MessageTime",{attrs:{message:t}}):e._e(),"out"==t.flow?i("div",{staticClass:"my"},[i("div",{staticClass:"left"},[t.type==e.$TIM.TYPES.MSG_TEXT?i("div",{staticClass:"bubble"},[i("text-element",{attrs:{payload:t.payload,message:t}})],1):e._e(),t.type==e.$TIM.TYPES.MSG_IMAGE?i("div",{staticClass:"bubble"},[i("img",{staticClass:"img",attrs:{mode:"aspectFill",src:t.payload.imageInfoArray[0].url},on:{click:function(i){return e.onMsgClick(t)}}})]):e._e(),t.type==e.$TIM.TYPES.MSG_VIDEO?i("div",{staticClass:"bubble"},[i("video-element",{attrs:{payload:t.payload,message:t}})],1):e._e(),t.type==e.$TIM.TYPES.MSG_AUDIO?i("div",{staticClass:"bubble"},[i("div",{staticClass:"voice"},[i("sound-element",{attrs:{payload:t.payload,message:t}})],1)]):e._e(),t.type==e.$TIM.TYPES.MSG_FILE?i("div",{staticClass:"bubble"},[i("file-element",{attrs:{payload:t.payload,message:t}})],1):e._e()]),i("div",{staticClass:"right"},[i("img",{attrs:{src:e.userInfo.img},on:{click:function(t){return e.onAvatarClick(e.userInfo)}}})])]):i("div",{staticClass:"other"},[i("div",{staticClass:"left"},[i("img",{attrs:{src:e.toUserInfo.avatar},on:{click:function(t){return e.onAvatarClick(e.toUserInfo)}}})]),i("div",{staticClass:"right"},[i("div",{staticClass:"username"},[i("div",{staticClass:"name"},[e._v(e._s(e.toUserInfo.nick))])]),t.type==e.$TIM.TYPES.MSG_TEXT?i("div",{staticClass:"bubble"},[i("text-element",{attrs:{payload:t.payload,message:t}})],1):e._e(),t.type==e.$TIM.TYPES.MSG_IMAGE?i("div",{staticClass:"bubble"},[i("img",{staticClass:"img",attrs:{mode:"aspectFill",src:t.payload.imageInfoArray[0].url},on:{click:function(i){return e.onMsgClick(t)}}})]):e._e(),t.type==e.$TIM.TYPES.MSG_VIDEO?i("div",{staticClass:"bubble"},[i("video-element",{attrs:{payload:t.payload,message:t}})],1):e._e(),t.type==e.$TIM.TYPES.MSG_AUDIO?i("div",{staticClass:"bubble"},[i("div",{staticClass:"voice"},[i("sound-element",{attrs:{payload:t.payload,message:t}})],1)]):e._e()])])],1)}),i("van-image-preview",{attrs:{images:e.images},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}})],2)},s=[],o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e._l(e.contentList,function(t,n){return["text"===t.name?i("span",{key:n},[e._v(e._s(t.text))]):"img"===t.name?i("img",{key:n,attrs:{src:t.src,width:"20px",height:"20px"}}):e._e()]})],2)},a=[],m=i("49ab"),r={name:"TextElement",props:{payload:{type:Object,required:!0},message:{type:Object,required:!0}},computed:{contentList(){return Object(m["a"])(this.payload)}}},l=r,c=i("2877"),p=Object(c["a"])(l,o,a,!1,null,null,null),g=p.exports,d=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("img",{staticClass:"img",attrs:{mode:"aspectFill",src:e.payload.imageInfoArray[0].url}})},u=[],_={name:"ImageElemnt",props:{payload:{type:Object,required:!0},message:{type:Object,required:!0}}},x=_,j=Object(c["a"])(x,d,u,!1,null,"3649ed5d",null),h=j.exports,f=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"video"},[i("video",{staticClass:"video",attrs:{src:e.payload.videoUrl,controls:""}})])},v=[],y={name:"VideoElement",props:{payload:{type:Object,required:!0},message:{type:Object,required:!0},methods:{videoError(e){console.log(e.target.error.message)}}}},b=y,M=(i("d02a"),Object(c["a"])(b,f,v,!1,null,"a6dfe7b6",null)),w=M.exports,C=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("van-icon",{attrs:{name:"volume-o",title:"单击播放"},on:{click:e.play}}),e._v("\n   "+e._s(e.payload.second+'"')+"\n")],1)},E=[],k={name:"SoundElement",props:{payload:{type:Object,required:!0},message:{type:Object,required:!0}},components:{},data(){return{amr:null}},computed:{url(){return this.payload.url},size(){return this.payload.size},second(){return this.payload.second}},methods:{play(){const e=document.createElement("audio");e.addEventListener("error",this.tryPlayAMR),e.src=this.url;const t=e.play();t&&t.catch(()=>{})},tryPlayAMR(){try{const t=/MSIE|Trident|Edge/.test(window.navigator.userAgent);if(t)return void this.$store.commit("showMessage",{message:"您的浏览器不支持该格式的语音消息播放，请尝试更换浏览器，建议使用：谷歌浏览器",type:"warning"});if(!window.BenzAMRRecorder){const e=document.createElement("script");e.addEventListener("load",this.playAMR),e.src="./BenzAMRRecorder.js";const t=document.getElementsByTagName("script")[0];return void t.parentNode.insertBefore(e,t)}this.playAMR()}catch(e){this.$store.commit("showMessage",{message:"您的浏览器不支持该格式的语音消息播放，请尝试更换浏览器，建议使用：谷歌浏览器",type:"warning"})}},playAMR(){!this.amr&&window.BenzAMRRecorder&&(this.amr=new window.BenzAMRRecorder),this.amr.isInit()?this.amr.play():this.amr.initWithUrl(this.url).then(()=>{this.amr.play()})}}},I=k,O=Object(c["a"])(I,C,E,!1,null,null,null),$=O.exports,T=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"file-element-wrapper",attrs:{title:"单击下载"},on:{click:e.downloadFile}},[i("div",{staticClass:"header"},[i("i",{staticClass:"el-icon-document file-icon"}),i("div",{staticClass:"file-element"},[i("span",{staticClass:"file-name"},[e._v(e._s(e.fileName))]),i("span",{staticClass:"file-size"},[e._v(e._s(e.size))])])])])},S=[],A={name:"FileElement",props:{payload:{type:Object,required:!0},message:{type:Object,required:!0}},computed:{fileName(){return this.payload.fileName},fileUrl(){return this.payload.fileUrl},size(){const e=this.payload.fileSize;return e>1024?e/1024>1024?`${this.toFixed(e/1024/1024)} Mb`:`${this.toFixed(e/1024)} Kb`:`${this.toFixed(e)}B`}},methods:{toFixed(e,t=2){return e.toFixed(t)},downloadFile(){if(window.fetch)fetch(this.fileUrl).then(e=>e.blob()).then(e=>{let t=document.createElement("a"),i=window.URL.createObjectURL(e);t.href=i,t.download=this.fileName,t.click()});else{let e=document.createElement("a");e.href=this.fileUrl,e.target="_blank",e.download=this.filename,e.click()}}}},F=A,N=(i("480d"),Object(c["a"])(F,T,S,!1,null,"9d5e7cec",null)),P=N.exports,z=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"message-time"},[e._v(e._s(e.timeFliter(e.message.time)))])},U=[],R=i("ed08"),q={name:"MessageTime",props:{message:{type:Object,required:!0}},methods:{timeFliter(e){let t=new Date(1e3*e),i=Object(R["a"])(t);return i}}},L=q,D=(i("ed86"),Object(c["a"])(L,z,U,!1,null,"685e2fed",null)),G=D.exports,Y={name:"MessageList",props:{currentMessageList:{type:Array,default:()=>[]},userInfo:{type:Object,default:()=>{}},toUserInfo:{type:Object,default:()=>{}}},components:{TextElement:g,ImageElemnt:h,VideoElement:w,SoundElement:$,FileElement:P,MessageTime:G},data(){return{show:!1,images:[]}},methods:{msgListClick(){this.$bus.$emit("hideDrawer")},timeFliter(e,t){if(0===t)return!0;if(t<this.currentMessageList.length-1){let i=e.time,n=this.currentMessageList[t+1].time;const s=n-i;return s>300}},onAvatarClick(e){this.$emit("onAvatarClick",e)},onMsgClick(e){const t=e.payload.imageInfoArray[0].url;this.images=[t],this.show=!0}}},B=Y,V=(i("fc1a"),Object(c["a"])(B,n,s,!1,null,"154d12ca",null));t["a"]=V.exports},"1caa":function(e,t,i){},"480d":function(e,t,i){"use strict";var n=i("777a"),s=i.n(n);s.a},"49ab":function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i("65a7");function s(e){let t=[],i=e.text,s=-1,o=-1;while(""!==i)switch(s=i.indexOf("["),o=i.indexOf("]"),s){case 0:if(-1===o)t.push({name:"text",text:i}),i="";else{let e=i.slice(0,o+1);n["a"][e]?(t.push({name:"img",src:n["c"]+n["a"][e]}),i=i.substring(o+1)):(t.push({name:"text",text:"["}),i=i.slice(1))}break;case-1:t.push({name:"text",text:i}),i="";break;default:t.push({name:"text",text:i.slice(0,s)}),i=i.substring(s);break}return t}},5364:function(e,t,i){},"65a7":function(e,t,i){"use strict";i.d(t,"c",function(){return n}),i.d(t,"a",function(){return s}),i.d(t,"b",function(){return o});const n="https://imgcache.qq.com/open/qcloud/tim/assets/emoji/",s={"[NO]":"emoji_0@2x.png","[OK]":"emoji_1@2x.png","[下雨]":"emoji_2@2x.png","[么么哒]":"emoji_3@2x.png","[乒乓]":"emoji_4@2x.png","[便便]":"emoji_5@2x.png","[信封]":"emoji_6@2x.png","[偷笑]":"emoji_7@2x.png","[傲慢]":"emoji_8@2x.png","[再见]":"emoji_9@2x.png","[冷汗]":"emoji_10@2x.png","[凋谢]":"emoji_11@2x.png","[刀]":"emoji_12@2x.png","[删除]":"emoji_13@2x.png","[勾引]":"emoji_14@2x.png","[发呆]":"emoji_15@2x.png","[发抖]":"emoji_16@2x.png","[可怜]":"emoji_17@2x.png","[可爱]":"emoji_18@2x.png","[右哼哼]":"emoji_19@2x.png","[右太极]":"emoji_20@2x.png","[右车头]":"emoji_21@2x.png","[吐]":"emoji_22@2x.png","[吓]":"emoji_23@2x.png","[咒骂]":"emoji_24@2x.png","[咖啡]":"emoji_25@2x.png","[啤酒]":"emoji_26@2x.png","[嘘]":"emoji_27@2x.png","[回头]":"emoji_28@2x.png","[困]":"emoji_29@2x.png","[坏笑]":"emoji_30@2x.png","[多云]":"emoji_31@2x.png","[大兵]":"emoji_32@2x.png","[大哭]":"emoji_33@2x.png","[太阳]":"emoji_34@2x.png","[奋斗]":"emoji_35@2x.png","[奶瓶]":"emoji_36@2x.png","[委屈]":"emoji_37@2x.png","[害羞]":"emoji_38@2x.png","[尴尬]":"emoji_39@2x.png","[左哼哼]":"emoji_40@2x.png","[左太极]":"emoji_41@2x.png","[左车头]":"emoji_42@2x.png","[差劲]":"emoji_43@2x.png","[弱]":"emoji_44@2x.png","[强]":"emoji_45@2x.png","[彩带]":"emoji_46@2x.png","[彩球]":"emoji_47@2x.png","[得意]":"emoji_48@2x.png","[微笑]":"emoji_49@2x.png","[心碎了]":"emoji_50@2x.png","[快哭了]":"emoji_51@2x.png","[怄火]":"emoji_52@2x.png","[怒]":"emoji_53@2x.png","[惊恐]":"emoji_54@2x.png","[惊讶]":"emoji_55@2x.png","[憨笑]":"emoji_56@2x.png","[手枪]":"emoji_57@2x.png","[打哈欠]":"emoji_58@2x.png","[抓狂]":"emoji_59@2x.png","[折磨]":"emoji_60@2x.png","[抠鼻]":"emoji_61@2x.png","[抱抱]":"emoji_62@2x.png","[抱拳]":"emoji_63@2x.png","[拳头]":"emoji_64@2x.png","[挥手]":"emoji_65@2x.png","[握手]":"emoji_66@2x.png","[撇嘴]":"emoji_67@2x.png","[擦汗]":"emoji_68@2x.png","[敲打]":"emoji_69@2x.png","[晕]":"emoji_70@2x.png","[月亮]":"emoji_71@2x.png","[棒棒糖]":"emoji_72@2x.png","[汽车]":"emoji_73@2x.png","[沙发]":"emoji_74@2x.png","[流汗]":"emoji_75@2x.png","[流泪]":"emoji_76@2x.png","[激动]":"emoji_77@2x.png","[灯泡]":"emoji_78@2x.png","[炸弹]":"emoji_79@2x.png","[熊猫]":"emoji_80@2x.png","[爆筋]":"emoji_81@2x.png","[爱你]":"emoji_82@2x.png","[爱心]":"emoji_83@2x.png","[爱情]":"emoji_84@2x.png","[猪头]":"emoji_85@2x.png","[猫咪]":"emoji_86@2x.png","[献吻]":"emoji_87@2x.png","[玫瑰]":"emoji_88@2x.png","[瓢虫]":"emoji_89@2x.png","[疑问]":"emoji_90@2x.png","[白眼]":"emoji_91@2x.png","[皮球]":"emoji_92@2x.png","[睡觉]":"emoji_93@2x.png","[磕头]":"emoji_94@2x.png","[示爱]":"emoji_95@2x.png","[礼品袋]":"emoji_96@2x.png","[礼物]":"emoji_97@2x.png","[篮球]":"emoji_98@2x.png","[米饭]":"emoji_99@2x.png","[糗大了]":"emoji_100@2x.png","[红双喜]":"emoji_101@2x.png","[红灯笼]":"emoji_102@2x.png","[纸巾]":"emoji_103@2x.png","[胜利]":"emoji_104@2x.png","[色]":"emoji_105@2x.png","[药]":"emoji_106@2x.png","[菜刀]":"emoji_107@2x.png","[蛋糕]":"emoji_108@2x.png","[蜡烛]":"emoji_109@2x.png","[街舞]":"emoji_110@2x.png","[衰]":"emoji_111@2x.png","[西瓜]":"emoji_112@2x.png","[调皮]":"emoji_113@2x.png","[象棋]":"emoji_114@2x.png","[跳绳]":"emoji_115@2x.png","[跳跳]":"emoji_116@2x.png","[车厢]":"emoji_117@2x.png","[转圈]":"emoji_118@2x.png","[鄙视]":"emoji_119@2x.png","[酷]":"emoji_120@2x.png","[钞票]":"emoji_121@2x.png","[钻戒]":"emoji_122@2x.png","[闪电]":"emoji_123@2x.png","[闭嘴]":"emoji_124@2x.png","[闹钟]":"emoji_125@2x.png","[阴险]":"emoji_126@2x.png","[难过]":"emoji_127@2x.png","[雨伞]":"emoji_128@2x.png","[青蛙]":"emoji_129@2x.png","[面条]":"emoji_130@2x.png","[鞭炮]":"emoji_131@2x.png","[风车]":"emoji_132@2x.png","[飞吻]":"emoji_133@2x.png","[飞机]":"emoji_134@2x.png","[饥饿]":"emoji_135@2x.png","[香蕉]":"emoji_136@2x.png","[骷髅]":"emoji_137@2x.png","[麦克风]":"emoji_138@2x.png","[麻将]":"emoji_139@2x.png","[鼓掌]":"emoji_140@2x.png","[龇牙]":"emoji_141@2x.png"},o=["[龇牙]","[调皮]","[流汗]","[偷笑]","[再见]","[敲打]","[擦汗]","[猪头]","[玫瑰]","[流泪]","[大哭]","[嘘]","[酷]","[抓狂]","[委屈]","[便便]","[炸弹]","[菜刀]","[可爱]","[色]","[害羞]","[得意]","[吐]","[微笑]","[怒]","[尴尬]","[惊恐]","[冷汗]","[爱心]","[示爱]","[白眼]","[傲慢]","[难过]","[惊讶]","[疑问]","[困]","[么么哒]","[憨笑]","[爱情]","[衰]","[撇嘴]","[阴险]","[奋斗]","[发呆]","[右哼哼]","[抱抱]","[坏笑]","[飞吻]","[鄙视]","[晕]","[大兵]","[可怜]","[强]","[弱]","[握手]","[胜利]","[抱拳]","[凋谢]","[米饭]","[蛋糕]","[西瓜]","[啤酒]","[瓢虫]","[勾引]","[OK]","[爱你]","[咖啡]","[月亮]","[刀]","[发抖]","[差劲]","[拳头]","[心碎了]","[太阳]","[礼物]","[皮球]","[骷髅]","[挥手]","[闪电]","[饥饿]","[咒骂]","[折磨]","[抠鼻]","[鼓掌]","[糗大了]","[左哼哼]","[打哈欠]","[快哭了]","[吓]","[篮球]","[乒乓]","[NO]","[跳跳]","[怄火]","[转圈]","[磕头]","[回头]","[跳绳]","[激动]","[街舞]","[献吻]","[左太极]","[右太极]","[闭嘴]","[猫咪]","[红双喜]","[鞭炮]","[红灯笼]","[麻将]","[麦克风]","[礼品袋]","[信封]","[象棋]","[彩带]","[蜡烛]","[爆筋]","[棒棒糖]","[奶瓶]","[面条]","[香蕉]","[飞机]","[左车头]","[车厢]","[右车头]","[多云]","[下雨]","[钞票]","[熊猫]","[灯泡]","[风车]","[闹钟]","[雨伞]","[彩球]","[钻戒]","[沙发]","[纸巾]","[手枪]","[青蛙]"]},"777a":function(e,t,i){},"8d82":function(e,t,i){"use strict";var n=i("f834"),s=i.n(n);s.a},"9fea":function(e,t,i){},d02a:function(e,t,i){"use strict";var n=i("1caa"),s=i.n(n);s.a},d05c:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"container"},[i("div",{staticClass:"chatinput"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.textMsg,expression:"textMsg"}],attrs:{type:"text"},domProps:{value:e.textMsg},on:{input:function(t){t.target.composing||(e.textMsg=t.target.value)}}}),i("div",{staticClass:"right"},[i("van-icon",{attrs:{name:"smile-o",size:"28"},on:{click:e.showEmoj}}),i("van-icon",{class:e.textMsg.trim()?"hidden":"",attrs:{name:"add-o",size:"28"},on:{click:e.showMore}}),i("div",{directives:[{name:"show",rawName:"v-show",value:e.textMsg.trim(),expression:"textMsg.trim()"}],staticClass:"send",on:{click:e.sendText}},[i("div",{staticClass:"btn"},[e._v("发送")])])],1)]),i("div",{staticClass:"menu",class:{hidden:e.hideMenu}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!e.hideEmoj,expression:"!hideEmoj"}],staticClass:"emojis"},e._l(e.emojiName,function(t){return i("div",{key:t,staticClass:"emoji",on:{click:function(i){return e.chooseEmoji(t)}}},[i("img",{staticStyle:{width:"30px",height:"30px"},attrs:{src:e.emojiUrl+e.emojiMap[t]}})])}),0),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.hideMore,expression:"!hideMore"}],staticClass:"more"},e._l(e.menus,function(t,n){return i("div",{key:n,staticClass:"more-item",on:{click:function(i){return e.chooseMenu(t)}}},[i("van-icon",{attrs:{name:t.icon,size:t.size}}),e._v(e._s(t.menusName)+"\n      ")],1)}),0)]),i("input",{ref:"imagePicker",staticStyle:{display:"none"},attrs:{type:"file",id:"imagePicker",accept:".jpg, .jpeg, .png, .gif"},on:{change:e.sendImage}}),i("input",{ref:"videoPicker",staticStyle:{display:"none"},attrs:{type:"file",id:"videoPicker",accept:".mp4"},on:{change:e.sendVideo}}),i("input",{ref:"filePicker",staticStyle:{display:"none"},attrs:{type:"file",id:"filePicker"},on:{change:e.sendFile}})])},s=[],o=i("65a7"),a={props:{hideMenu:{type:Boolean,default:!0},hideEmoj:{type:Boolean,default:!0},hideMore:{type:Boolean,default:!0}},data(){return{emojiMap:o["a"],emojiName:o["b"],emojiUrl:o["c"],menus:[{icon:"photo-o",size:"24",menusName:"相册"},{icon:"video-o",size:"24",menusName:"视频"},{icon:"idcard",size:"24",menusName:"文件"}],textMsg:""}},methods:{showEmoj(){this.$emit("showEmoj")},showMore(){this.$emit("showMore")},chooseEmoji(e){this.textMsg+=e},chooseMenu(e){"相册"===e.menusName?this.$refs.imagePicker.click():"视频"===e.menusName?this.$refs.videoPicker.click():"文件"===e.menusName&&this.$refs.filePicker.click()},sendText(){this.$emit("sendText",this.textMsg),this.textMsg=""},sendImage(){this.$emit("sendImage")},sendVideo(){this.$emit("sendVideo")},sendFile(){this.$emit("sendFile")}}},m=a,r=(i("8d82"),i("2877")),l=Object(r["a"])(m,n,s,!1,null,"030e10cd",null);t["a"]=l.exports},ed08:function(e,t,i){"use strict";i.d(t,"a",function(){return n});const n=(e,t={})=>{const{part:i=0,dateComplete:n=!1,timeComplete:s=!0,dateConnector:o="-",timeConnector:a=":",hour12:m=!1,needSecond:r=!1}=t;(new Date).getTime();let l=(new Date).getFullYear(),c=(new Date).getMonth()+1,p=(new Date).getDate(),g=e.getFullYear(),d=e.getMonth()+1,u=e.getDate(),_=e.getHours(),x=e.getMinutes(),j=e.getSeconds(),h="",f="",v=!1;l===g&&(v=!0);let y=!1;return l===g&&c===d&&p===u&&(y=!0),n&&(d<10&&(d="0"+d),u<10&&(u="0"+u)),h=g+o+d+o+u,m&&(_>12?(_-=12,s&&(_=_<10?"下午 0"+_:"下午 "+_)):s&&(_=_<10?"上午 0"+_:"上午 "+_)),s&&(x<10&&(x="0"+x),j<10&&(j="0"+j)),f=_+a+x+a+j,0==i?y?r?f:_+a+x:v?r?f:d+o+u+" "+_+a+x:r?h+" "+f:h+" "+_+a+x:1==i?h:2==i?f:"传参有误"}},ed86:function(e,t,i){"use strict";var n=i("5364"),s=i.n(n);s.a},f834:function(e,t,i){},fc1a:function(e,t,i){"use strict";var n=i("9fea"),s=i.n(n);s.a}}]);
//# sourceMappingURL=chunk-718e3422.d0fa9722.js.map